---
layout: default
---

<div class="page">
    <aside class="sidebar">
        <div class="sidebar-photos"></div>
    </aside>

    <article class="content">
        <!-- everything else in your article layout stays the same -->


    <article class="content">
        <header class="article-header">
            <h1>{{ page.title }}</h1>
        
            {% if page.subtitle %}
                <p class="article-subtitle">{{ page.subtitle }}</p>
            {% endif %}
        
            {% if page.contributor %}
            {% assign contributor_page = site.pages
            | where: "layout", "contributor"
            | where: "slug", page.contributor_slug
            | first %}
            
            <p class="article-byline">
                By
                {% if contributor_page %}
                <a href="{{ contributor_page.url | relative_url }}">
                    {{ page.contributor }}
                </a>
                {% else %}
                {{ page.contributor }}
                {% endif %}
            </p>
            {% endif %}

            <!-- {% if page.contributor %}
                <p class="article-byline">
                    By
                        {% if page.contributor_slug %}
                        <a href="{{ '/contributors/' | append: page.contributor_slug | append: '/' | relative_url }}">
                            {{ page.contributor }}
                        </a>
                        {% else %}
                        {{ page.contributor }}
                        {% endif %}
                </p>
            {% endif %} -->

            {%- comment -%}
            Word count + reading time (≈250 wpm), based on actual article content.
            {%- endcomment -%}
            {% assign words = content
            | strip_html
            | strip_newlines
            | replace: "&nbsp;", " "
            | replace: " ", " "
            | split: " "
            | size %}
            
            {%- comment -%}
            minutes_x2 is minutes * 2 in half-minute units, rounded up.
            e.g. 566 words → 2.5 minutes, 742 words → 3 minutes.
            {%- endcomment -%}
            {% assign words_times2 = words | times: 2 %}
            {% assign minutes_x2 = words_times2 | divided_by: 250 %}
            {% assign remainder = words_times2 | modulo: 250 %}
            {% if remainder > 0 %}
            {% assign minutes_x2 = minutes_x2 | plus: 1 %}
            {% endif %}
            
            {% assign minutes = minutes_x2 | divided_by: 2 %}
            {% assign half = minutes_x2 | modulo: 2 %}
            
            <p class="article-reading">
                {{ words }} words
                {% if minutes_x2 <= 1 %} (less than 1 minute read) {% else %} ({{ minutes }}{% if half==1 %}.5{% endif
                    %} {% if minutes==1 and half==0 %} minute{% else %} minute{% endif %} read) {% endif %} </p>
        
        </header>

    
        {{ content }}

        {%- comment -%}
        References link: right-aligned, subtle, based on refs_slug or refs_url.
        {%- endcomment -%}
        {% assign refs_url = nil %}
        
        {% if page.refs_slug %}
        {% assign refs_url = "/references/" | append: page.refs_slug | append: ".html" %}
        {% elsif page.refs_url %}
        {% assign refs_url = page.refs_url %}
        {% endif %}
        
        {% if refs_url %}
        <p class="article-references-link">
            <a href="{{ refs_url | relative_url }}">Works Cited</a>
        </p>
        {% endif %}
        

                {%- comment -%}
                Build the ordered list of article pages:
                - Only files in /articles/
                - Exclude the index page itself
                - Sorted by title
                {%- endcomment -%}
                {% assign articles = site.pages
                | where: "dir", "/articles/"
                | where_exp: "p", "p.name != 'index.md'"
                | sort: "title" %}
                
                {%- comment -%}
                Find the current page's index in that list.
                {%- endcomment -%}
                {% assign current_index = nil %}
                {% for p in articles %}
                {% if p.url == page.url %}
                {% assign current_index = forloop.index0 %}
                {% endif %}
                {% endfor %}
                
                {% assign article_count = articles | size %}
                
                {% if current_index != nil and article_count > 0 %}
                {% assign last_index = article_count | minus: 1 %}
                
                {%- comment -%}
                Circular "previous":
                - Normally current_index - 1
                - If we're at 0, wrap to last_index
                {%- endcomment -%}
                {% assign prev_index = current_index | minus: 1 %}
                {% if prev_index < 0 %} {% assign prev_index=last_index %} {% endif %} {%- comment -%} Circular "next" : - Normally
                    current_index + 1 - If we're at last_index, wrap to 0 {%- endcomment -%} {% assign next_index=current_index | plus:
                    1 %} {% if next_index> last_index %}
                    {% assign next_index = 0 %}
                    {% endif %}
                
                    {% assign prev_article = articles[prev_index] %}
                    {% assign next_article = articles[next_index] %}
                
                    <nav class="article-nav">
                        {% if prev_article %}
                        <div class="article-nav-prev">
                            <span class="article-nav-label">Earlier</span><br>
                            <a class="article-nav-link" href="{{ prev_article.url | relative_url }}">
                                {{ prev_article.title }}
                            </a>
                        </div>
                        {% endif %}
                
                        {% if next_article %}
                        <div class="article-nav-next">
                            <span class="article-nav-label">Later</span>
                            <a class="article-nav-link" href="{{ next_article.url | relative_url }}">
                                {{ next_article.title }}
                            </a>
                        </div>
                        {% endif %}
                    </nav>
                    {% endif %}

        </div>
            <!-- existing article nav etc. stays above here -->
            
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    const sidebar = document.querySelector('.sidebar-photos');
                    const content = document.querySelector('.content');

                    if (!sidebar || !content) return;

                    // --- Image pools ---

                    // First image must be one of these posters:
                    const posterImages = [
                        {
                            src: "{{ '/assets/images/posters/happiness-club-thumb.jpg' | relative_url }}",
                            alt: "Historic protest poster: Happiness is a Warm Club"
                        },
                        {
                            src: "{{ '/assets/images/posters/inheritance-poster-thumb.jpg' | relative_url }}",
                            alt: "Modern protest poster: Inheritance"
                        }
                    ];

                    // All other images can be drawn from historical posters + historical photos
                    const photoImages = [
                        // historical-posters (add paths you actually have here)
                        {
                            src: "{{ '/assets/images/historical-posters/happiness-club.jpg' | relative_url }}",
                            alt: "Historical protest poster"
                        },
                        {
                            src: "{{ '/assets/images/historical-posters/inheritance-poster.jpg' | relative_url }}",
                            alt: "Contemporary protest poster"
                        },

                        // historical-photos (from your list)
                        { src: "{{ '/assets/images/historical-photos/17000_students_support_police.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/admin_bldg_sit_in.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/aft_picket_line.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/aft_pickets.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/arrested_and_bloodied.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/back_to_skool_picket.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/bearded_man.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/bloody_tuesday_head.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/cafeteria_banners.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/cafeteria_banners2.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/calif_republic_flag.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/crowds_marching.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/gagged_guitar.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/girl_cry.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/hari_dillon.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/kay_boyle.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/medic_tripped.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/medical_vols.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/medical_vols2.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/medical_vols3.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/medical_vols4.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/mounted_police.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/negociate_pickets.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/no_police_state_picket.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/onlookers.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/pd_revolver.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/peace_street_light.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/pickelhaube.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/police_column.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/police_ground_fight.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/police_line.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/police_line_cafeteria.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/police_pin_ground.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/press_interview.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/press_interview2.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/pulled_apart.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/riot_gear.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/riot_police.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/speakers_platform_crowd.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/speakers_platform_crowd2.png' | relative_url }}", alt: "Historical protest photo" },
                        { src: "{{ '/assets/images/historical-photos/strike_daily_ed1.png' | relative_url }}", alt: "Historical protest photo" }
                    ];

                    // --- Decide how many images based on article height ---

                    const contentRect = content.getBoundingClientRect();
                    const contentHeight = contentRect.height;

                    // Approximate each image block as ~220px tall (image + margins)
                    const approxPerImage = 220;

                    let imageCount = Math.round(contentHeight / approxPerImage);

                    // Clamp to a reasonable range
                    if (imageCount < 2) imageCount = 2;
                    if (imageCount > 10) imageCount = 10;

                    // --- Helper for random selection ---
                    function pickRandom(array) {
                        return array[Math.floor(Math.random() * array.length)];
                    }

                    // Make a mutable copy so we don't repeat too much
                    const availablePhotos = photoImages.slice();
                    const chosen = [];

                    // 1) First image: random poster
                    const firstPoster = pickRandom(posterImages);
                    chosen.push(firstPoster);

                    // 2) Remaining images: random from historical pools
                    for (let i = 1; i < imageCount; i++) {
                        if (availablePhotos.length === 0) break;
                        const idx = Math.floor(Math.random() * availablePhotos.length);
                        chosen.push(availablePhotos[idx]);
                        availablePhotos.splice(idx, 1); // avoid immediate repeats
                    }

                    // --- Render into sidebar ---

                    // --- Render into sidebar with hyperlinks ---

                    chosen.forEach(function (img, index) {
                        const figure = document.createElement('figure');
                        figure.className = 'sidebar-photo-frame';

                        let link = document.createElement('a');

                        if (index === 0) {
                            // FIRST IMAGE = POSTER → LINK TO POSTER PAGE
                            if (img.src.includes('happiness-club')) {
                                link.href = "{{ '/posters/happiness-club/' | relative_url }}";
                            } else if (img.src.includes('inheritance-poster')) {
                                link.href = "{{ '/posters/inheritance-poster/' | relative_url }}";
                            } else {
                                // fallback if ever needed
                                link.href = img.src;
                            }
                        } else {
                            // ALL OTHER IMAGES LINK DIRECTLY TO THEIR FULL IMAGE URL
                            link.href = img.src;
                            link.target = "_blank";
                        }

                        const el = document.createElement('img');
                        el.className = 'sidebar-photo';
                        el.src = img.src;
                        el.alt = img.alt || '';

                        link.appendChild(el);
                        figure.appendChild(link);
                        sidebar.appendChild(figure);
                    });

                });
            </script>

    </article>

</div>